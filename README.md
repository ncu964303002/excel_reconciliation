# Excel 資料比對工具

## 📋 簡介

專業的多檔案 Excel 資料勾稽比對系統，適用於各種資料核對場景。

## 🎯 主要功能

- **多檔案上傳**：支援同時上傳 2 個以上的 Excel 檔案（.xlsx、.xls）
- **複合 Key 比對**：每個檔案可選擇多個欄位組成複合 Key 進行比對
- **靈活比對模式**：
  - 聯集：顯示所有檔案中出現的 Key
  - 交集：僅顯示所有檔案共同的 Key
  - 指定主檔：以某一檔案為基準進行比對
- **自訂輸出欄位**：可勾選要包含在結果中的欄位
- **視覺化結果**：提供圓餅圖、長條圖等圖表呈現比對結果
- **分類檢視**：依據比對結果分類顯示（完全相符、僅在某檔案、部分缺失）
- **匯出報告**：將比對結果匯出為 Excel 檔案

## 🚀 快速開始

### 使用方式

1. **開啟工具**
   - 直接在瀏覽器中開啟 `index.html` 檔案
   - 或將整個專案部署到網頁伺服器

2. **上傳檔案**
   - 點擊上傳區域或拖曳 Excel 檔案
   - 至少需要上傳 2 個檔案

3. **設定比對**
   - 為每個檔案設定標籤（自訂名稱）
   - 勾選 Key 欄位（可多選）
   - 選擇比對模式（聯集/交集/主檔）

4. **選擇輸出欄位**
   - 勾選要在結果中顯示的欄位
   - 可使用「全選」或「取消全選」快速操作

5. **執行比對**
   - 點擊「開始比對」按鈕
   - 查看視覺化結果和詳細資料表

6. **匯出結果**
   - 點擊「匯出 Excel」將結果下載為 Excel 檔案

7. **比較下一筆**
   - 點擊「清除，比較下一筆」重新開始

## 📊 輸出說明

### 比對結果分類

- **完全相符**：在所有檔案中都存在的 Key
- **僅在某檔案**：只在特定檔案中存在的 Key
- **部分缺失**：在部分檔案中存在，但不是全部

### 匯出 Excel 內容

匯出的 Excel 檔案包含兩個工作表：

1. **摘要**：檔案資訊、統計數據
2. **詳細資料**：完整的比對結果，包含所有選中的欄位

## 💡 使用範例

### 範例 1：基本比對
- 上傳「檔案 A」和「檔案 B」
- 兩個檔案都選擇「編號」作為 Key
- 選擇「聯集」模式
- 查看哪些編號只在 A 或只在 B

### 範例 2：複合 Key 比對
- 上傳「檔案 A」和「檔案 B」
- 同時選擇「年份」和「月份」作為複合 Key
- 選擇「交集」模式
- 只顯示兩個檔案都有的年月組合

### 範例 3：主檔比對
- 上傳「主要清單」和「次要清單」
- 選擇「指定主檔」模式，以「主要清單」為基準
- 查看主要清單中的每一筆在次要清單中是否存在

## ⚙️ 技術資訊

### 系統需求

- 現代瀏覽器（Chrome、Firefox、Edge、Safari）
- 支援 JavaScript
- 無需安裝任何軟體

### 使用的技術

- **前端框架**：純 HTML、CSS、JavaScript
- **Excel 處理**：SheetJS (xlsx.js)
- **圖表呈現**：Chart.js

### 檔案說明

```
專案目錄/
├── index.html          # 主程式（單一檔案，包含所有功能）
└── README.md           # 說明文件（本檔案）
```

## 🔒 隱私與安全

- **完全本地執行**：所有資料處理都在瀏覽器本地進行
- **不上傳資料**：檔案不會傳送到任何伺服器
- **無需登入**：不需要帳號或網路連線
- **資料不保存**：關閉頁面後資料即清除

## 📝 注意事項

1. Excel 檔案會讀取第一個工作表的資料
2. 請確保要比對的欄位在所有檔案中都存在
3. 建議在比對前先確認資料格式一致
4. 大型檔案（超過 10MB）可能需要較長處理時間
5. 複合 Key 會將多個欄位的值組合比對

## 🆘 常見問題

**Q: 支援哪些 Excel 格式？**  
A: 支援 .xlsx 和 .xls 格式。

**Q: 可以上傳幾個檔案？**  
A: 至少 2 個，沒有上限，但建議不超過 10 個以確保效能。

**Q: 如果檔案很大怎麼辦？**  
A: 建議先在 Excel 中篩選需要的資料，或分批比對。

**Q: 可以比對多個工作表嗎？**  
A: 目前只支援第一個工作表，如需比對其他工作表請先在 Excel 中調整順序。

**Q: 結果可以複製到其他軟體嗎？**  
A: 可以，匯出的 Excel 檔案可以在 Excel、Google Sheets 等軟體中開啟。

## 📄 授權

本工具僅供內部使用。

---

**版本**：1.0  
**最後更新**：2024
